import { ArgsTable, Canvas, Meta, Story } from '@storybook/addon-docs';
import { useState, useRef } from 'react';
import { Form, Button, Row, Col, InputGroup, Card } from '../../src/index';

<Meta title="Components/Form/Patterns" component={Form} />

# Address Pattern

Use this base pattern when you require users to key in their Singapore-based address.

Example below is an illustration of querying a postal code from [**OneMap API**](https://www.onemap.gov.sg/docs/) which maps back an address property value to the address input field.

Pairing `<Form.Label>` with `<Form.Control>` can simply be done by including **htmlFor** and **id** attribute in each subcomponent respectively. Alternatively, you may wrap both subcomponents within `<Form.Group>` with the **controlId** attribute.

**Note**: Give your users the option to either key in their postal code to look up their address, or enter their full address manually.

export const AddressPatternTemplate = (args) => {
  const [value, setValue] = useState({});
  const inputRef = useRef();
  const handleSubmit = () => {
    event.preventDefault();
    event.stopPropagation();
    fetch(
      'https://developers.onemap.sg/commonapi/search?searchVal=' +
        inputRef.current.value +
        '&returnGeom=Y&getAddrDetails=Y'
    )
      .then((response) => response.json())
      .then((json) => setValue(json.results[0]));
  };
  return (
    <Form onSubmit={handleSubmit} {...args}>
      <Form.Group as={Row} className="mb-3" controlId="formBasicPostalCode">
        <Col xs={4}>
          <Form.Label>Postal Code</Form.Label>
          <Form.Control
            ref={inputRef}
            type="number"
            placeholder="e.g 730317"
            autoComplete="postal-code"
            maxLength={6}
            onInput={(e) => {
              e.target.value = e.target.value.slice(0, e.target.maxLength);
            }}
          />
        </Col>
        <Col xs={12} className="mt-3">
          <Button type="submit">Find Address</Button>
        </Col>
      </Form.Group>
      <Form.Group className="mb-3" controlId="formBasicStreet">
        <Form.Label>Block/Street Name</Form.Label>
        <Form.Control
          defaultValue={value?.ADDRESS}
          type="text"
          placeholder="e.g 220 Pasir Ris Drive 50"
          autoComplete="street-address"
          className="w-50"
        />
      </Form.Group>
      <Form.Group className="mb-3" controlId="formBasicBuilding">
        <Form.Label>Building/House Number</Form.Label>
        <Form.Text className="text-muted" id="buildingHint">If applicable</Form.Text>
        <Form.Control
          type="text"
          placeholder=""
          className="w-25"
          autoComplete="on"
          aria-describedby="buildingHint"
        />
      </Form.Group>
      <Form.Group className="mb-3" controlId="formBasicUnitNumber">
        <Form.Label>Unit Number</Form.Label>
        <Form.Text className="text-muted" id="UnitHint">If applicable</Form.Text>
        <Form.Control type="text" className="w-50" autoComplete="on" aria-describedby="unitHint" />
      </Form.Group>
    </Form>
  );
};

<Canvas>
  <Story name="Address">{AddressPatternTemplate.bind({})}</Story>
</Canvas>

```jsx
import { useState, useRef } from 'react';
import { Form, Button, Row, Col } from '@govtechsg/sgds-react';

const [value, setValue] = useState({});
const inputRef = useRef();

// fetch api example
const handleSubmit = () => {
  event.preventDefault();
  event.stopPropagation();
  fetch(
    'https://developers.onemap.sg/commonapi/search?searchVal=' +
      inputRef.current.value +
      '&returnGeom=Y&getAddrDetails=Y'
  )
    .then((response) => response.json())
    .then((json) => setValue(json.results[0]));
};

<Form onSubmit={handleSubmit}>
  <Form.Group as={Row} className="mb-3" controlId="formBasicPostalCode">
    <Col xs={4}>
      <Form.Label>Postal Code</Form.Label>
      <Form.Control
        ref={inputRef}
        type="number"
        placeholder="e.g 730317"
        autoComplete="postal-code"
        maxLength={6}
        onInput={(e) => {
          e.target.value = e.target.value.slice(0, e.target.maxLength);
        }}
      />
    </Col>
    <Col xs={12} className="mt-3">
      <Button type="submit">Find Address</Button>
    </Col>
  </Form.Group>
  <Form.Group className="mb-3" controlId="formBasicStreet">
    <Form.Label>Block/Street Name</Form.Label>
    <Form.Control
      defaultValue={value?.ADDRESS}
      type="text"
      placeholder="e.g 220 Pasir Ris Drive 50"
      autoComplete="street-address"
      className="w-50"
    />
  </Form.Group>
  <Form.Group className="mb-3" controlId="formBasicBuilding">
    <Form.Label>Building/House Number</Form.Label>
    <Form.Text className="text-muted" id="buildingHint">If applicable</Form.Text>
    <Form.Control
      type="text"
      placeholder=""
      className="w-25"
      autoComplete="on"
      aria-describedby="buildingHint"
    />
  </Form.Group>
  <Form.Group className="mb-3" controlId="formBasicUnitNumber">
    <Form.Label>Unit Number</Form.Label>
    <Form.Text className="text-muted" id="UnitHint">If applicable</Form.Text>
    <Form.Control 
      type="text" 
      className="w-50" 
      autoComplete="on" 
      aria-describedby="unitHint" 
    />
  </Form.Group>
</Form>;
```

# Date Pattern

Use this base pattern when you want to ask users for a specific date, e.g their date of birth or when something was issued to them.

**Note**: If you need users to select from a few specific dates, we recommend that you use the `Radio button` component instead to allow them to choose easily. Alternatively, you may use the `DatePicker` component for users to select dates.

You can choose from 2 ways of asking for dates, which can be seen in the examples below.

## Single Date Input

Base format when requiring users to type in dates for your services. Do state clearly how the data should be filled (e.g 01 01 2020 vs 1 1 2020).

export const DatePatternSingleTemplate = (args) => {
  return (
    <Form {...args}>
      <Form.Group as={Col} className="mb-3">
        <Form.Label htmlFor="singleDate">Date of Birth</Form.Label>
        <Form.Text className="text-muted" id="dobHint">e.g 01 Jun 1979</Form.Text>
        <Form.Control
          className="w-50"
          type="text"
          id="singleDate"
          autoComplete="on"
          aria-describedby="dobHint"
          required
        />
      </Form.Group>
    </Form>
  );
};

<Canvas>
  <Story name="Single Date">{DatePatternSingleTemplate.bind({})}</Story>
</Canvas>

```jsx
import { Form } from '@govtechsg/sgds-react';
import { useState } from 'react';

<Form>
  <Form.Group as={Col} className="mb-3">
    <Form.Label htmlFor="singleDate">Date of Birth</Form.Label>
    <Form.Text className="text-muted" id="dobHint">e.g 01 Jun 1979</Form.Text>
    <Form.Control
      className="w-50"
      type="text"
      id="singleDate"
      autoComplete="on"
      aria-describedby="dobHint"
      required
    />
  </Form.Group>
</Form>;
```

## Isolated Date Input

Base format when requesting users to fill in memorable dates, with the aid of `autoComplete` attribute for these 3 fields, `bday-day`,`bday-month` and `bday-year` to bring convenience to users.

export const DatePatternIsolatedTemplate = (args) => {
  return (
    <Form {...args}>
      <Row xs={8} sm={7} md={6}>
        <Form.Group as={Col} className="mb-3">
          <Form.Label htmlFor="dobDay">DD</Form.Label>
          <Form.Control
            type="number"
            id="dobDay"
            autoComplete="bday-day"
            pattern="\d*"
            maxLength={2}
            onInput={(e) => {
              e.target.value = e.target.value.slice(0, e.target.maxLength);
            }}
            required
          />
        </Form.Group>
        <Form.Group as={Col} className="mb-3">
          <Form.Label htmlFor="dobMonth">MM</Form.Label>
          <Form.Control
            type="number"
            id="dobMonth"
            autoComplete="bday-month"
            pattern="\d*"
            maxLength={2}
            onInput={(e) => {
              e.target.value = e.target.value.slice(0, e.target.maxLength);
            }}
            required
          />
        </Form.Group>
        <Form.Group as={Col} className="mb-3">
          <Form.Label htmlFor="dobYear">YYYY</Form.Label>
          <Form.Control
            type="number"
            id="dobYear"
            autoComplete="bday-year"
            pattern="\d*"
            maxLength={4}
            onInput={(e) => {
              e.target.value = e.target.value.slice(0, e.target.maxLength);
            }}
            required
          />
        </Form.Group>
      </Row>
    </Form>
  );
};

<Canvas>
  <Story name="Isolated Date">{DatePatternIsolatedTemplate.bind({})}</Story>
</Canvas>

```jsx
import { Form, Row, Col } from '@govtechsg/sgds-react';
import { useState } from 'react';

<Form>
  <Row xs={8} sm={7} md={6}>
    <Form.Group as={Col} className="mb-3">
      <Form.Label htmlFor="dobDay">DD</Form.Label>
      <Form.Control
        type="number"
        id="dobDay"
        autoComplete="bday-day"
        pattern="\d*"
        maxLength={2}
        onInput={(e) => {
          e.target.value = e.target.value.slice(0, e.target.maxLength);
        }}
        required
      />
    </Form.Group>
    <Form.Group as={Col} className="mb-3">
      <Form.Label htmlFor="dobMonth">MM</Form.Label>
      <Form.Control
        type="number"
        id="dobMonth"
        autoComplete="bday-month"
        pattern="\d*"
        maxLength={2}
        onInput={(e) => {
          e.target.value = e.target.value.slice(0, e.target.maxLength);
        }}
        required
      />
    </Form.Group>
    <Form.Group as={Col} className="mb-3">
      <Form.Label htmlFor="dobYear">YYYY</Form.Label>
      <Form.Control
        type="number"
        id="dobYear"
        autoComplete="bday-year"
        pattern="\d*"
        maxLength={4}
        onInput={(e) => {
          e.target.value = e.target.value.slice(0, e.target.maxLength);
        }}
        required
      />
    </Form.Group>
  </Row>
</Form>;
```

# Email Pattern

Use this base pattern when you need to ask users for their email address.

**Note**: State clearly what their email address will be used for.

export const EmailPatternTemplate = (args) => {
  return (
    <Form {...args}>
      <Form.Group className="mb-3">
        <Form.Label htmlFor="email">Email Address</Form.Label>
        <Form.Text className="text-muted" id="EmailPurpose">
          Your email will only be used for updates
        </Form.Text>
        <Form.Control
          className="w-50"
          id="email"
          type="email"
          aria-describedby="EmailPurpose"
          placeholder="Enter email"
          maxLength={256}
          required
          autoComplete="email"
          spellCheck={false}
        />
      </Form.Group>
    </Form>
  );
};

<Canvas>
  <Story name="Email">{EmailPatternTemplate.bind({})}</Story>
</Canvas>

```jsx
import { Form } from '@govtechsg/sgds-react';
import { useState } from 'react';

<Form>
  <Form.Group className="mb-3">
    <Form.Label htmlFor="email">Email Address</Form.Label>
    <Form.Text className="text-muted" id="EmailPurpose">
      Your email will only be used for updates
    </Form.Text>
    <Form.Control
      className="w-50"
      id="email"
      type="email"
      aria-describedby="EmailPurpose"
      placeholder="Enter email"
      maxLength={256}
      required
      autoComplete="email"
      spellCheck={false}
    />
  </Form.Group>
</Form>;
```

# Phone Number

Use this pattern when you need to ask users for their phone number

**Note**: State clearly what their phone number will be used for.

export const PhonePatternTemplate = (args) => {
  return (
    <>
      <Form.Label htmlFor="phone">Phone Number</Form.Label>
      <InputGroup className="mb-3 w-50">
        <InputGroup.Text id="basic-addon1">+65</InputGroup.Text>
        <Form.Control
          id="phone"
          type="number"
          placeholder="12345678"
          aria-label="Phone"
          aria-describedby="basic-addon1"
          pattern="\d*"
          maxLength="8"
          onInput={(e) => {
            e.target.value = e.target.value.slice(0, e.target.maxLength);
          }}
          autoComplete="tel-local"
          required
        />
      </InputGroup>
    </>
  );
};

<Canvas>
  <Story name="Phone Number">{PhonePatternTemplate.bind({})}</Story>
</Canvas>

```jsx
import { InputGroup,Form } from '@govtechsg/sgds-react';

<Form.Label htmlFor="phone">Phone Number</Form.Label>
<InputGroup className="mb-3 w-50">
  <InputGroup.Text id="basic-addon1">+65</InputGroup.Text>
  <Form.Control
          id="phone"
          type="number"
          placeholder="12345678"
          aria-label="Phone"
          aria-describedby="basic-addon1"
          pattern="\d*"
          maxLength="8"
          onInput={(e) => {
              e.target.value = e.target.value.slice(0, e.target.maxLength);
          }}
          autoComplete="tel-local"
          required
    />
</InputGroup>
```

# Name

Use this pattern when you need to ask users for their names.

## General name field

You should follow this pattern when you need to ask for a user’s name. You should only ask for names if you need it for a service.

export const NamePatternTemplate = (args) => {
  return (
    <Form>
      <Form.Group as={Col} xs={6} className="mb-3" controlId="fullName">
        <Form.Label>Full name as per NRIC</Form.Label>
        <Form.Control
          type="text"
          autoComplete="name"
          name="name"
          spellCheck={false}
          required
        />
      </Form.Group>
    </Form>
  );
};

<Canvas>
  <Story name="General name">{NamePatternTemplate.bind({})}</Story>
</Canvas>

```jsx
import { Form, Col } from '@govtechsg/sgds-react';

<Form>
  <Form.Group as={Col} xs={6} className="mb-3" controlId="fullName">
    <Form.Label>Full name as per NRIC</Form.Label>
    <Form.Control
      type="text"
      autoComplete="name"
      name="name"
      spellCheck={false}
      required
    />
  </Form.Group>
</Form>;
```

## Multiline name field

You should follow this pattern when you know that your users will follow the given-name and family-name convention.

export const MultilineNamePatternTemplate = (args) => {
  return (
    <Form>
      <Form.Group as={Col} xs={6} className="mb-3" controlId="givenName">
        <Form.Label>Given Name</Form.Label>
        <Form.Control
          type="text"
          autoComplete="given-name"
          name="given-name"
          spellCheck={false}
          required
        />
      </Form.Group>
      <Form.Group as={Col} xs={6} className="mb-3" controlId="familyName">
        <Form.Label>Family Name</Form.Label>
        <Form.Control
          type="text"
          autoComplete="family-name"
          name="family-name"
          spellCheck={false}
          required
        />
      </Form.Group>
    </Form>
  );
};

<Canvas>
  <Story name="Multiline name">{MultilineNamePatternTemplate.bind({})}</Story>
</Canvas>

```jsx
import { Form, Col } from '@govtechsg/sgds-react';

<Form>
  <Form.Group as={Col} xs={6} className="mb-3" controlId="givenName">
    <Form.Label>Given Name</Form.Label>
    <Form.Control
      type="text"
      autoComplete="given-name"
      name="given-name"
      spellCheck={false}
      required
    />
  </Form.Group>
  <Form.Group as={Col} xs={6} className="mb-3" controlId="familyName">
    <Form.Label>Family Name</Form.Label>
    <Form.Control
      type="text"
      autoComplete="family-name"
      name="family-name"
      spellCheck={false}
      required
    />
  </Form.Group>
</Form>;
```

# Multiple Options

You should follow this pattern by using `<fieldset>` and `<legend>`. This will ensure that assistive technologies — such as screen readers — will announce the related question when reading out the options.

export const MultilineCheckboxesTemplate = (args) => {
  return (
    <Form>
      <fieldset>
      <legend className="form-label">How do you know about us?</legend>
        <FormCheck
          id="option-1"
          label="Friends"
        />
        <FormCheck
          id="option-2"
          label="Newsletter"
        />
      </fieldset>
    </Form>
  );
};

<Canvas>
  <Story name="Multiple Options">{MultilineCheckboxesTemplate.bind({})}</Story>
</Canvas>

```jsx
import { Form, Col } from '@govtechsg/sgds-react';

<Form>
  <Form.Group as={Col} xs={6} className="mb-3" controlId="givenName">
    <Form.Check
      id="option-1"
      label="I am default a checkbox (change me)"
    />
    <Form.Check
      id="option-2"
      label="I am default a checkbox (change me)"
    />
  </Form.Group>
</Form>;
```

# Payment

Use this pattern when you need to ask for their payment details.

export const PaymentPatternTemplate = (args) => {
  const [cardExpDate, setCardExpDate] = useState('');
  const [cardNumber, setCardNumber] = useState('');
  const handleChangeCardExpDate = (e) => {
    if (e.target.value.length === 3 && e.target.value.charAt(2) !== '/') {
      e.target.value =
        e.target.value.substr(0, 2) + '/' + e.target.value.charAt(2);
    } else if (
      e.target.value.length === 3 &&
      e.target.value.charAt(2) === '/'
    ) {
      e.target.value = e.target.value.substr(0, 2);
    }
    setCardExpDate(e.target.value);
  };
  const handleChangeCardNumber = (e) => {
    if (e.target.value.length === 5 && e.target.value.charAt(4) !== ' ') {
      e.target.value =
        e.target.value.substr(0, 4) + ' ' + e.target.value.charAt(4);
    } else if (
      e.target.value.length === 10 &&
      e.target.value.charAt(9) !== ' '
    ) {
      e.target.value =
        e.target.value.substr(0, 9) + ' ' + e.target.value.charAt(9);
    } else if (
      e.target.value.length === 15 &&
      e.target.value.charAt(14) !== ' '
    ) {
      e.target.value =
        e.target.value.substr(0, 14) + ' ' + e.target.value.charAt(14);
    }
    setCardNumber(e.target.value);
  };
  return (
    <Form>
      <Form.Group as={Col} xs={6} className="mb-3" controlId="fullName2">
        <Form.Label>Name on card</Form.Label>
        <Form.Control
          type="text"
          autoComplete="name"
          name="name"
          spellCheck={false}
          required
        />
      </Form.Group>
      <Form.Group as={Col} xs={6} className="mb-3" controlId="cardNumber">
        <Form.Label>Card number</Form.Label>
        <Form.Text className="text-muted" id="sixteenDigits">
          Enter the 16-digit number on the card
        </Form.Text>
        <Form.Control
          type="text"
          value={cardNumber}
          aria-describedby="sixteenDigits"
          onChange={handleChangeCardNumber}
          autoComplete="cc-number"
          name="cc-number"
          pattern="\d*"
          maxLength="19"
          required
        />
      </Form.Group>
      <Row>
        <Form.Group as={Col} xs={2} className="mb-3" controlId="expiryDate">
          <Form.Label>Expiry date</Form.Label>
          <Form.Text className="text-muted" id="monthYear">MM/YY</Form.Text>
          <Form.Control
            type="text"
            value={cardExpDate}
            aria-describedby="monthYear"
            onChange={handleChangeCardExpDate}
            autoComplete="cc-exp"
            pattern="\d*"
            maxLength="5"
            name="cc-exp"
            required
          />
        </Form.Group>
        <Form.Group as={Col} xs={4} className="mb-3" controlId="cvv">
          <Form.Label>CVV</Form.Label>
          <Form.Text className="text-muted" id="threeDigits">
            The 3 digit number at the back of card
          </Form.Text>
          <Form.Control
            type="number"
            aria-describedby="threeDigits"
            autoComplete="cc-csc"
            pattern="\d\*"
            maxLength="3"
            onInput={(e) => {
              e.target.value = e.target.value.slice(0, e.target.maxLength);
            }}
            name="cc-csc"
            required
          />
        </Form.Group>
      </Row>
    </Form>
  );
};

<Canvas>
  <Story name="Payment">{PaymentPatternTemplate.bind({})}</Story>
</Canvas>

```jsx
import { Form, Row, Col } from '@govtechsg/sgds-react';
import { useState } from 'react';

const [cardExpDate, setCardExpDate] = useState('');
const [cardNumber, setCardNumber] = useState('');

const handleChangeCardExpDate = (e) => {
  if (e.target.value.length === 3 && e.target.value.charAt(2) !== '/') {
    e.target.value =
      e.target.value.substr(0, 2) + '/' + e.target.value.charAt(2);
  } else if (e.target.value.length === 3 && e.target.value.charAt(2) === '/') {
    e.target.value = e.target.value.substr(0, 2);
  }
  setCardExpDate(e.target.value);
};

const handleChangeCardNumber = (e) => {
  if (e.target.value.length === 5 && e.target.value.charAt(4) !== ' ') {
    e.target.value =
      e.target.value.substr(0, 4) + ' ' + e.target.value.charAt(4);
  } else if (e.target.value.length === 10 && e.target.value.charAt(9) !== ' ') {
    e.target.value =
      e.target.value.substr(0, 9) + ' ' + e.target.value.charAt(9);
  } else if (
    e.target.value.length === 15 &&
    e.target.value.charAt(14) !== ' '
  ) {
    e.target.value =
      e.target.value.substr(0, 14) + ' ' + e.target.value.charAt(14);
  }
  setCardNumber(e.target.value);
};

<Form>
  <Form.Group as={Col} xs={6} className="mb-3" controlId="fullName2">
    <Form.Label>Name on card</Form.Label>
    <Form.Control
      type="text"
      autoComplete="name"
      name="name"
      spellCheck={false}
      required
    />
  </Form.Group>
  <Form.Group as={Col} xs={6} className="mb-3" controlId="cardNumber">
    <Form.Label>Card number</Form.Label>
    <Form.Text className="text-muted" id="sixteenDigits">
      Enter the 16-digit number on the card
    </Form.Text>
    <Form.Control
      type="text"
      value={cardNumber}
      aria-describedby="sixteenDigits"
      onChange={handleChangeCardNumber}
      autoComplete="cc-number"
      name="cc-number"
      pattern="\d*"
      maxLength="19"
      required
    />
  </Form.Group>
  <Row>
    <Form.Group as={Col} xs={2} className="mb-3" controlId="expiryDate">
      <Form.Label>Expiry date</Form.Label>
      <Form.Text className="text-muted" id="monthYear">MM/YY</Form.Text>
      <Form.Control
        type="text"
        value={expDate}
        aria-describedby="monthYear"
        onChange={handleChangeCardExpDate}
        autoComplete="cc-exp"
        name="cc-exp"
        pattern="\d*"
        maxLength="4"
        required
      />
    </Form.Group>
    <Form.Group as={Col} xs={4} className="mb-3" controlId="cvv">
      <Form.Label>CVV</Form.Label>
      <Form.Text className="text-muted" id="threeDigits">
        The 3 digit number at the back of card
      </Form.Text>
      <Form.Control
        type="number"
        aria-describedby="threeDigits"
        autoComplete="cc-csc"
        name="cc-csc"
        pattern="\d*"
        maxLength="3"
        onInput={(e) => {
          e.target.value = e.target.value.slice(0, e.target.maxLength);
        }}
        required
      />
    </Form.Group>
  </Row>
</Form>;
```

# Error Summary

Use this pattern to showcase a summary of errors the user has made at the top of the page. Refer to the `Card` component for further details on usage.

export const ErrorSummaryTemplate = (args) => {
  return (
    <Col xs={6}>
      <Card border="danger" style={{ backgroundColor: '#FFF4F3' }}>
        <Card.Body>
          <Card.Title as="h3">
            There is a problem with your submission
          </Card.Title>
          <Row>
            <Card.Text as="a" className="text-danger" href="#">
              The date format entered is wrong
            </Card.Text>
          </Row>
          <Row>
            <Card.Text as="a" className="text-danger" href="#">
              Address must be filled in
            </Card.Text>
          </Row>
          <Row>
            <Card.Text as="a" className="text-danger" href="#">
              Email address is not valid
            </Card.Text>
          </Row>
        </Card.Body>
      </Card>
    </Col>
  );
};

<Canvas>
  <Story name="Error Summary">{ErrorSummaryTemplate.bind({})}</Story>
</Canvas>

```jsx
import { Card, Row, Col } from '@govtechsg/sgds-react';

<Col xs={6}>
  <Card border="danger" style={{ backgroundColor: '#FFF4F3' }}>
    <Card.Body>
      <Card.Title as="h3">There is a problem with your submission</Card.Title>
      <Row>
        <Card.Text as="a" className="text-danger" href="#">
          The date format entered is wrong
        </Card.Text>
      </Row>
      <Row>
        <Card.Text as="a" className="text-danger" href="#">
          Address must be filled in
        </Card.Text>
      </Row>
      <Row>
        <Card.Text as="a" className="text-danger" href="#">
          Email address is not valid
        </Card.Text>
      </Row>
    </Card.Body>
  </Card>
</Col>;
```
