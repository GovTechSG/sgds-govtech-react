import { ArgsTable, Canvas, Meta, Story } from '@storybook/addon-docs';
import { useState, useEffect } from 'react';
import { Pagination, PageItem, Table } from '../../src/components/index';
import { PaginationExtended } from '../../src/components/index';

<Meta title="MDX/PaginationExtended" component={PaginationExtended} />

export const Template = (args) => {
  const renderData = (data) => {
    return (
      <>
        {data.map((post, index) => {
          return (
            <tr key={index}>
              <td>{post.id}</td>
              <td key={index}>{post.title}</td>
              <td>{post.body}</td>
            </tr>
          );
        })}
      </>
    );
  };
  const [data, setData] = useState([]);
  const [currentPage, setCurrentPage] = useState(1);
  const [itemsPerPage, setItemsPerPage] = useState(5);
    const indexOfLastItem = currentPage * itemsPerPage;
  const indexofFirstItem = indexOfLastItem - itemsPerPage;
  const currentItems = data.slice(indexofFirstItem, indexOfLastItem);
  useEffect(() => {
    fetch('https://jsonplaceholder.typicode.com/posts')
      .then((response) => response.json())
      .then((json) => setData(json));
    return () => {
      setData([]); // This worked for me
    };
  }, []);
  return (
    <div>
      <Table striped bordered hover>
        <thead>
          <tr>
            <th>Id</th>
            <th>Title</th>
            <th>Body</th>
          </tr>
        </thead>
        <tbody>
          {renderData(currentItems)}
        </tbody>
      </Table>
       <PaginationExtended
       {...args}
        dataLength= {data.length}
        currentPage={currentPage}
        setCurrentPage={setCurrentPage}
        itemsPerPage={itemsPerPage}
        setItemsPerPage={setItemsPerPage}
      />
    </div>
  );
};

<Canvas>
  <Story name="PaginationExtended">{Template.bind({})}</Story>
</Canvas>

<ArgsTable story="PaginationExtended"/>
